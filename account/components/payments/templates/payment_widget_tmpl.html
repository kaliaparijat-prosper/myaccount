
<pr-notification ng-repeat="notification in persistedNotifications | orderBy:'orderId'" type="notification.type" heading="notification.heading" subtext="notification.subtext" close="notification.showClose" scroll="notification.scroll"></pr-notification>

<div class="show-for-small hide-for-mediumlarge" ng-show="!isFlatCancelledLoan">
    <div class="row loans-section panel-secondary">
        <div class="small-12 columns mobile loan-title">
            <a href="#" ng-click="showLoanDetails = !showLoanDetails">
                <div class="row vertical-centered-parent">
                    <div class="small-11 columns">
                        <h3>Your {{loan.amountBorrowedWithNoDecimal}} {{loan.purpose}}</h3>
                    </div>
                    <div class="small-1 columns float-right loan-details-toggle vertical-centered">
                        <img class='action-required-icon' ng-show="showLoanDetails === false" ng-src="{{railsVariables.close2Icon}}" alt="Action" />
                        <img class='action-required-icon action-required-icon-pullup' ng-show="showLoanDetails" ng-src="{{railsVariables.pullUpIcon}}" alt="Close" />
                    </div>
                </div>
            </a>
        </div>
        <div class="small-12 columns loan-details" ng-show="showLoanDetails">
            <div class="row">
                <div class="small-12 end columns">
                    <p class="caption loan-number">Loan {{loan.number}}</p>
                    <p class="caption loan-status" ng-class="{'green-status strong': loan.status === 'CLOSED' && !debtSale}" ng-bind-html="loan.statusText"></p>
                </div>
            </div>
            <div class="row">
                <div class="small-12 small-centered columns">
                    <div class="progress-wrapper" ng-click>
                        <div class="progress ng-cloak" ng-style="getStyle()">
                            <div class="progress-text-wrapper text-center">
                                <span class="progress-text-completed">{{loan.paidOffPercentage}}</span>
                                <span class="progress-percent-symbol">%</span>
                                <div class="progress-completion-text">PAID OFF</div>
                            </div>
                        </div>
                        <div
                                round-progress
                                max="max"
                                current="loan.paidOffPercentage"
                                color="{{ getColor() }}"
                                bgcolor="{{ bgColor }}"
                                radius="{{ radius }}"
                                semi="isSemi"
                                rounded="rounded"
                                stroke="{{ stroke }}"
                                clockwise="clockwise"
                                responsive="responsive"
                                duration="{{ duration }}"
                                animation="{{ currentAnimation }}"
                                offset="{{ offset }}">

                            <svg>
                                <linearGradient id="gradient" x1="0" x2="0" y1="0" y2="1">
                                    <stop offset="5%"  stop-color="#C1CF2E"/>
                                    <stop offset="95%" stop-color="#399C3F"/>
                                </linearGradient>
                            </svg>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row loan-key-info text-center">
                <div class="small-12 small-centered columns">

                    <div class="make-table content-centered">
                        <div class="make-table-row">
                            <div class="make-table-cell loan-key-info-item">
                                <h6>RATE</h6>
                                <h4>{{loan.rate}}</h4>
                            </div>
                            <div class="make-table-cell loan-key-info-item">
                                <h6>DUE</h6>
                                <h4>{{loan.due.date.monthly_unformatted | formatDateWithOnlySuffix}}</h4>
                            </div>
                            <div class="make-table-cell loan-key-info-item">
                                <h6>PAYMENT</h6>
                                <h4>{{loan.due.amount.monthly || noAmountDue}}</h4>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row loan-details-table text-left">
                <div class="small-12 small-centered columns">
                    <div class="" ng-if="(showAutoPayRow && loan.daysPastDue > 0) || loan.autopay.unavailable || loan.bankAccounts.length === 0">
                        <div class="loan-details-table-label autopay-unavailable">
                            <h6 class="loan-details-key">
                                AutoPay is unavailable
                                <a href="#" class="auto-pay-unavailable-tooltip">
                                    <img ng-src="{{railsVariables.helpIcon}}"/>
                                </a>
                            </h6>
                        </div>
                    </div>
                    <div class="make-table content-centered">
                        <div class="make-table-row" ng-if="(showAutoPayRow && loan.daysPastDue === 0) && !loan.autopay.unavailable && loan.bankAccounts.length !== 0">
                            <div class="make-table-cell loan-details-table-label">
                                <h6 class="loan-details-key">
                                    AutoPay <span ng-class="{highlightAutoPay: (loan.autopay.status === 'ON' || autoPayStatusText === 'ON') }">{{autoPayStatusText}}</span>
                                     <span class="loan-info-tip-toggle" ng-click="autoPay.tooltip = !autoPay.tooltip">
                                        <img ng-show="autoPay.tooltip" class='tooltipCloseIcon' ng-src="{{railsVariables.closeGrayIcon}}" />
                                        <img ng-hide="autoPay.tooltip" class='tooltipHelpIcon' ng-src="{{railsVariables.helpIcon}}" />
                                     </span>
                                </h6>
                            </div>
                            <div class="make-table-cell">
                                <h6 class="loan-details-value" ng-if="loan.autopay.status === 'OFF' && autoPayStatusText === 'OFF'"><button ng-class="{autoPayDisabled: autoPayDisabled}" class="secondary small-rounded" data-m="button-turn-autopayon" ng-click="accountEventTrackerService.trackEvents('event_turn_autopayon');turnOnAutoPayIfAutoPayEnabled()">Turn on AutoPay</button></h6>
                                <h6 class="loan-details-value" ng-if="loan.autopay.status === 'ON'  || autoPayStatusText === 'ON'">{{loan.autopay.bankName}}&nbsp;{{loan.autopay.account}}</h6>
                            </div>
                        </div>
                    </div>
                    <div class="make-table content-centered loan-details-autopay-section">
                        <div class="make-table-row">
                            <div class="make-table-cell">
                                <div class="accountArrowBox autoPayBox" ng-show="autoPay.tooltip" ng-bind-html="autoPayTooltiptext"></div>
                            </div>
                        </div>
                    </div>
                    <div class="make-table content-centered loan-details-table-section">
                        <div class="make-table-row">
                            <div class="make-table-cell">
                                <h6 class="loan-details-key">Originated:</h6>
                            </div>
                            <div class="make-table-cell">
                                <h6 class="loan-details-value text-right">{{loan.originatedDate}}</h6>
                            </div>
                        </div>
                        <div class="make-table-row">
                            <div class="make-table-cell">
                                <h6 class="loan-details-key">Loan term:</h6>
                            </div>
                            <div class="make-table-cell">
                                <h6 class="loan-details-value text-right">{{loan.termInMonths}}</h6>
                            </div>
                        </div>
                        <div class="make-table-row">
                            <div class="make-table-cell">
                                <h6 class="loan-details-key">Maturity date:</h6>
                            </div>
                            <div class="make-table-cell">
                                <h6 class="loan-details-value text-right">{{loan.maturityDate}}</h6>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div ng-show="showLoanMainContent">
            <div class="small-12 columns loan-pressing-info">
            <div class="row text-left">
                <div class="small-12 columns">
                    <div class="row">
                        <div class="small-12 float-left columns">
                            <p class="clear-bottom-padding">{{rightPane.row1.label}}
                                <span class="loan-info-tip-toggle" ng-click="rightPane.row1.tooltip = !rightPane.row1.tooltip">
                                        <img ng-show="rightPane.row1.tooltip" class='tooltipCloseIcon' ng-src="{{railsVariables.closeGrayIcon}}" />
                                        <img ng-hide="rightPane.row1.tooltip" class='tooltipHelpIcon' ng-src="{{railsVariables.helpIcon}}" />
                                </span>

                                <span class="float-right" ng-class="{'bold': rightPane.row1.amount === '$0'}">
                                    {{rightPane.row1.amount}}
                                </span>

                            </p>
                            <div class="accountArrowBox" ng-show="rightPane.row1.tooltip">{{rightPane.row1.tooltipText}}</div>
                            <p class="disclaimer paymentRightPaneMessageField" ng-show="rightPane.row1.tooltip === false && rightPane.row1.message">{{rightPane.row1.message}}</p>
                        </div>
                    </div>
                    <div class="row">
                        <div class="small-12 float-left columns">
                            <p class="clear-bottom-padding">{{rightPane.row2.label}}
                                <span class="loan-info-tip-toggle" ng-click="rightPane.row2.tooltip = !rightPane.row2.tooltip">
                                            <img ng-show="rightPane.row2.tooltip" class='tooltipCloseIcon' ng-src="{{railsVariables.closeGrayIcon}}" />
                                            <img ng-hide="rightPane.row2.tooltip" class='tooltipHelpIcon' ng-src="{{railsVariables.helpIcon}}" />
                                </span>
                                <span class="float-right">{{loan.payment.last.amount | formatZeroAsNA}}

                                </span>

                            </p>
                            <div class="accountArrowBox" ng-show="rightPane.row2.tooltip">{{rightPane.row2.tooltipText}}</div>
                            <p class="disclaimer paymentRightPaneMessageField" ng-show="rightPane.row2.tooltip === false && rightPane.row2.message" ng-bind-html="rightPane.row2.message"></p>
                        </div>
                    </div>

                    <div class="row" ng-show="showDetailsThirdRow">
                        <div class="small-12 float-left columns">
                            <p class="clear-bottom-padding" ng-class="{'bold': rightPane.row3.boldLabel}">
                                {{rightPane.row3.label}}
                                <span class="loan-info-tip-toggle" ng-click="rightPane.row3.tooltip = !rightPane.row3.tooltip">
                                        <img ng-show="rightPane.row3.tooltip" class='tooltipCloseIcon' ng-src="{{railsVariables.closeGrayIcon}}" />
                                        <img ng-hide="rightPane.row3.tooltip" class='tooltipHelpIcon' ng-src="{{railsVariables.helpIcon}}" />
                                </span>
                                &nbsp;
                                <span class="bold">{{rightPane.row3.paymentDate}}</span>
                                <span class="float-right" class="bold" ng-bind-html="loan.monthlyPaymentAmount"></span>&nbsp;<span ng-show='showDueWarningText' class="warning make-inline-block showDueWarningText">Due in {{dueWarningText}} days</span>
                            </p>
                            <div class="accountArrowBox" ng-show="rightPane.row3.tooltip">{{rightPane.row3.tooltipText}}</div>
                            <p class="disclaimer paymentRightPaneMessageField" ng-show="rightPane.row3.tooltip === false && rightPane.row3.message" ng-bind-html="rightPane.row3.message"></p>
                        </div>
                    </div>

                    <div class="row" ng-show="showDetailsFourRow">
                        <div class="small-12 float-left columns">
                            <p class="clear-bottom-padding">{{rightPane.row4.label}}
                                <span class="loan-info-tip-toggle" ng-click="rightPane.row4.tooltip = !rightPane.row4.tooltip">
                                        <img ng-show="rightPane.row4.tooltip" class='tooltipCloseIcon' ng-src="{{railsVariables.closeGrayIcon}}" />
                                        <img ng-hide="rightPane.row4.tooltip" class='tooltipHelpIcon'  ng-src="{{railsVariables.helpIcon}}" />
                                </span>
                                <span class="float-right">{{rightPane.row4.totalMissedPayment}}</span>
                            </p>

                            <div class="accountArrowBox showDetailsFourRowBox" ng-show="rightPane.row4.tooltip">{{rightPane.row4.tooltipText}}</div>
                            <p class="disclaimer paymentRightPaneMessageField" ng-show="rightPane.row4.tooltip === false && rightPane.row4.message" ng-bind-html="rightPane.row4.message"></p>

                        </div>
                        <div ng-repeat="subRow in rightPane.row4.subRows">
                            <div class="small-8 float-left columns" >
                                <div class="make-inline-block">
                                    <p ng-bind-html="subRow.label"></p>
                                </div>
                            </div>
                            <div class="small-4 float-right columns text-right">
                                <div class="">
                                    <p ng-bind-html="subRow.message"></p>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
            <div class="small-12 columns  loan-additional-payment-info" ng-show="showAdditionalInfoRow">
                <div class="small-12 columns">
                    <p>{{additionalInfoRowMessage}}</p>
                </div>
            </div>
            <div class="small-12 columns  loan-paidoff-message" ng-show="loan.status === 'CLOSED' && loan.closedStatusBar">This is a big day - it's time to celebrate.</div>

            <div class="small-12 columns  loan-additional-payment-info" ng-show="loan.status !== 'CLOSED' && showPaymentBar && loan.autopay.status === 'ON'" >
                <div class="small-12 columns">
                    <p class="loans-caption"><span>You already have a payment scheduled.</span> If you make additional payments that add up to less than the full amount of your monthly payment before your due date, Prosper will still automatically pull {{loan.due.amount.monthly}} on your due date.</p>

                </div>
            </div>
            <div class="small-12 columns loan-payment-bar" ng-show="loan.status !== 'CLOSED'">
                <div class="row">
                <div class="small-12 small-centered columns">
                    <div class="row" ng-show="showPaymentBar">
                        <div class="small-12 text-center columns loan-payment-bar-title">
                            <p ng-show="loan.autopay.status === 'OFF'">Make a payment</p>
                            <p ng-show="loan.autopay.status === 'ON'">MAKE AN ADDITIONAL PAYMENT</p>
                        </div>
                    </div>
                    <form name="paymentForm" novalidate>
                        <div class="row" ng-show="showPaymentBar">
                            <div class="small-6 columns  make-payment-input-wrapper">
                                <input type="number"
                                       name="scheduledPaymentAmount"
                                       class="scheduledPaymentAmount"
                                       ng-blur="runPaymentBarPassSanityCheck()"
                                       ng-pattern="/^\d+(\.\d{1,2})?$/"
                                       ng-class="{'field-error': paymentForm.scheduledPaymentAmount.$invalid  || fieldError.makePaymentScheduledAmount}"
                                       required
                                       ng-model="makePaymentScheduledAmount"  />
                                <p class="loans-caption accountArrowBox accountFieldError" ng-show="fieldError.makePaymentScheduledAmount">
                                    {{fieldError.makePaymentScheduledAmount}}
                                </p>
                            </div>
                            <div class="small-6  columns make-payment-input-wrapper" >
                                <input type="text" class="scheduledPaymentDate" name="validatedDateInput" placeholder="{{placeholderText}}"
                                       pick-a-date="validatedDate"
                                       pick-a-date-options='payDateOptions'
                                       min-date="startDate"
                                       max-date="endDate"
                                       ng-model="makePaymentScheduledDate" required>
                                <p class="loans-caption accountArrowBox accountFieldError" ng-show="fieldError.makePaymentScheduledDate !== null">{{fieldError.makePaymentScheduledDate}}</p>
                            </div>
                        </div>
                        <div class="row">
                            <div class="small-12 small-centered columns" ng-show="payoffAmount !== ''">
                                <p class="micro make-table-cell payoffAmountDisplay" ng-bind-html="payoffAmount"></p>
                            </div>
                        </div>
                        <div class="row" ng-show="showPaymentBar">
                            <div class="small-12 columns select-bank-account make-payment-input-wrapper">
                                <select name="selectBankAccount" class="selectBankAccount"
                                        ng-options="bankAccount.bankAccountNameString for bankAccount in loan.bankAccounts track by bankAccount.wholeBankInfo.account_id"
                                        ng-disabled="loan.bankAccounts.length === 0"
                                        ng-class="{'field-error': paymentForm.selectBankAccount.$invalid  || fieldError.makePaymentScheduledAccount}"
                                        ng-model="makePaymentScheduledAccount">
                                    <option value="" ng-if="loan.bankAccounts.length === 0">No account available</option>

                                </select>
                                <p class="loans-caption accountArrowBox accountFieldError" ng-show="fieldError.makePaymentScheduledAccount !== null">{{fieldError.makePaymentScheduledAccount}}</p>
                            </div>
                        </div>
                    </form>
                    <div class="row">
                        <div class="small-12 small-centered columns make-payment-message" ng-show="makePayment.message !== ''">
                            <div class="make-table-cell make-payment-icon-wrapper">
                                <img class='clock-icon' ng-src="{{makePayment.footerIcon}}" alt="Clock" />
                            </div>
                            <p class="caption make-table-cell" ng-class="{ 'attention': makePayment.footerAttention }" ng-bind-html="makePayment.message"></p>
                        </div>
                    </div>


                    <div class="row">
                        <div class="small-12 text-center columns make-payment-action">
                            <button class="primary full-width half-padding" ng-show="showPaymentBar === false && loan.autopay.status === 'ON'" ng-click="showPaymentBar = true">Make an additional payment</button>
                            <button class="primary full-width half-padding" ng-show="showPaymentBar && loan.autopay.status === 'ON'" data-m="button-user-made-additional-payment" data-pax-name="MYACCOUNT:Payment:Additional Payment CTA:Clicked" data-pax-event-type="click" ng-click="validatePaymentFields(true);scrollToLoanTitle();">Make an additional payment</button>
                            <button class="primary full-width" ng-show="loan.autopay.status === 'OFF' && !thinPaymentBtn " data-m="button-user-made-payment" data-pax-name="MYACCOUNT:Payment:Make Payment CTA:Clicked" data-pax-event-type="click" ng-click="accountEventTrackerService.trackEvents('event_user_made_payment');validatePaymentFields(true);scrollToLoanTitle();">Make a payment</button>
                            <button class="primary full-width"  ng-show="thinPaymentBtn" ng-click="showPaymentFields(true)">Make a payment</button>
                        </div>
                    </div>

                </div>
            </div>
            </div>

        </div>
        <div class="small-12 columns loan-confirmation" ng-show="showPaymentConfirmation">
            <div class="row text-left">
                <div class="small-12 columns">
                    <div class="row">
                        <div class="small-12 float-left columns confirm-payment-title">
                            <h3>Confirm your payment</h3>
                        </div>
                    </div>
                    <div class="row loan-additional-payment-info" ng-show="loan.autopay.status === 'ON'">
                        <div class="small-12 columns">
                            <p class="loans-caption"><span>You already have a payment scheduled.</span> If you make additional payments that add up to less than the full amount of your monthly payment before your due date, Prosper will still automatically pull {{loan.due.amount.monthly}} on your due date.</p>
                        </div>
                    </div>
                    <div class="row">
                        <div class="small-12 float-left columns confirm-payment-from">
                            <h6>From account</h6>
                            <h4>{{makePaymentScheduledAccount.wholeBankInfo.account_id | formatBankAccountName}}</h4>
                        </div>
                    </div>
                    <div class="row">
                        <div class="small-12 float-left columns confirm-payment-date">
                            <h6>Scheduled payment date</h6>
                            <h4>{{makePaymentScheduledDate | formatDate1}}</h4>
                        </div>
                    </div>
                    <div class="row">
                        <div class="small-12 float-left columns confirm-payment-amount">
                            <h6 class="strong" ng-show="loan.autopay.status === 'OFF'">Payment amount</h6>
                            <h6 class="strong" ng-show="loan.autopay.status === 'ON'">Additional payment amount</h6>
                            <h4 class="strong">{{makePaymentScheduledAmount | formatCurrency}}</h4>
                        </div>
                    </div>
                    <div class="row">
                        <div class="small-12 float-left columns confirm-readme">
                            <h6>By clicking 'Confirm your payment', you agree by electronic signature to withdraw from your account.<br/><a href="#" class="pink" ng-click="showMorePaymentInformation = true" ng-show="!showMorePaymentInformation">Read more</a>
                                <span ng-show="showMorePaymentInformation">
                                    <p class="disclaimer">
                                    I hereby authorize Prosper Funding LLC ("Prosper"), its parent or any of its affiliates to electronically debit the checking or savings account listed here for which I am an authorized user (“Account”) at the financial institution named here ("Financial Institution") for the transfer of funds in the amount and on the date listed above for the purpose of making a payment towards my loan.  I acknowledge that the origination of electronic debits to my Account must be permitted by my Financial Institution, which must be located in the United States.  I understand that this authorization will remain in full force and effect until Prosper has received oral or written notification from me at least 3 business days prior to my scheduled transfer to terminate this authorization.
                                    </p>
                                    <p class="disclaimer">I further acknowledge that, if I have authorized monthly automatic ACH loan payments from my Account, my next monthly loan payment will be reduced by the payment amount listed above.</p>
                                    <p class="disclaimer">Please print this authorization and retain a copy for your records.</p>
                                </span>
                            </h6>
                        </div>
                    </div>
                    <div class="row">
                        <div class="small-12 float-left columns confirm-payment-action">
                            <button class="primary half-padding stretch-full-width" ng-disabled="paymentRequestInProgress" ng-show="loan.autopay.status === 'OFF'" data-m="button-user-confirm-payment" data-pax-name="MYACCOUNT:Payment:Confirm Payment CTA:Clicked" data-pax-event-type="click"  ng-click="handlePayment('manual')">Confirm your payment</button>
                            <button class="primary half-padding stretch-full-width" ng-disabled="paymentRequestInProgress" ng-show="loan.autopay.status === 'ON'" data-m="button-user-confirm-payment" data-pax-name="MYACCOUNT:Payment:Confirm Payment CTA:Clicked" data-pax-event-type="click"  ng-click="handlePayment('auto')">Confirm your payment</button>
                            <button class="secondary gray half-padding stretch-full-width" ng-disabled="paymentRequestInProgress" data-m="button-user-edited-payment" ng-click="accountEventTrackerService.trackEvents('event_user_edited_payment_details');showPaymentConfirmation = false; showLoanMainContent = true">Edit</button>
                        </div>
                    </div>

                </div>
            </div>
        </div>
        <div ng-include = "'account/components/payments/templates/payment_success_confirmation_small_tmpl.html'"></div>
        <div ng-include = "'account/components/payments/templates/payment_fail_confirmation_small_tmpl.html'"></div>
        <auto-ach ng-show="showAutoACH"></auto-ach>
        <prosper-feature-flagged name="paymentDetails" variant="new">
         <pr-payment-details></pr-payment-details>
        </prosper-feature-flagged>
    </div>

</div>
<div class="show-for-mediumlarge" ng-show="!isFlatCancelledLoan">
    <div class="widget-loader" ng-show="widgetloading">Loading...</div>
    <div class="row loans-section panel-secondary">
        <div class="small-12 columns loan-title">
            <div class="row">
                <div class="medium-10 columns">
                    <h2>Your {{loan.amountBorrowedWithNoDecimal}} {{loan.purpose}}</h2>
                </div>
                <div class="medium-2 columns clear-left-padding float-right text-right">
                    <p class="caption loan-number">Loan {{loan.number}}</p>
                    <p class="caption loan-status" ng-class="{'green-status strong': loan.status === 'CLOSED' && !debtSale}" ng-bind-html="loan.statusText"></p>

                </div>
            </div>
        </div>
        <div class="small-12 columns loan-details">
            <div class="loan-details-pane make-table" >
                <div class="loan-sidebar" >
                    <div class="row">
                        <div class="small-12 columns">
                            <div class="progress-wrapper">
                        <div class="progress ng-cloak" ng-style="getStyle()">
                            <div class="progress-text-wrapper text-center">
                                <span class="progress-text-completed">{{ loan.paidOffPercentage }}</span>
                                <span class="progress-percent-symbol">%</span>
                                <div class="progress-completion-text">PAID OFF</div>
                            </div>
                        </div>
                        <div
                                round-progress
                                max="max"
                                current="loan.paidOffPercentage"
                                color="{{ getColor() }}"
                                bgcolor="{{ bgColor }}"
                                radius="{{ radius }}"
                                semi="isSemi"
                                rounded="rounded"
                                stroke="{{ stroke }}"
                                clockwise="clockwise"
                                responsive="responsive"
                                duration="{{ duration }}"
                                animation="{{ currentAnimation }}"
                                offset="{{ offset }}">

                            <svg>
                                <linearGradient id="gradient" x1="0" x2="0" y1="0" y2="1">
                                    <stop offset="5%"  stop-color="#C1CF2E"/>
                                    <stop offset="95%" stop-color="#399C3F"/>
                                </linearGradient>
                            </svg>
                        </div>
                    </div>
                        </div>
                    </div>
                    <div class="row loan-key-info text-center">
                        <div class="small-12 small-centered columns">
                            <div class="make-table content-centered">
                                <div class="make-table-row">
                                    <div class="make-table-cell loan-key-info-item">
                                        <h6>RATE</h6>
                                        <h4>{{loan.rate}}</h4>
                                    </div>
                                    <div class="make-table-cell loan-key-info-item">
                                        <h6>DUE</h6>
                                        <h4>{{loan.due.date.monthly_unformatted | formatDateWithOnlySuffix}}</h4>
                                    </div>
                                    <div class="make-table-cell loan-key-info-item">
                                        <h6>PAYMENT</h6>
                                        <h4>{{loan.due.amount.monthly || noAmountDue}}</h4>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row loan-details-table text-left">
                        <div class="small-12 small-centered columns">
                            <div  class="loan-details-table-label" ng-if="(showAutoPayRow && loan.daysPastDue > 0) || loan.autopay.unavailable || loan.bankAccounts.length === 0">
                                <h6 class="loan-details-key">
                                    AutoPay is unavailable
                                    <a href="#" class="auto-pay-unavailable-tooltip">
                                        <img ng-src="{{railsVariables.helpIcon}}"/>
                                    </a>
                                </h6>
                            </div>
                            <div class="make-table content-centered auto-pay">
                                <div class="make-table-row" ng-if="(showAutoPayRow && loan.daysPastDue === 0) && !loan.autopay.unavailable && loan.bankAccounts.length !== 0">
                                    <div class="make-table-cell loan-details-table-label">
                                        <h6 class="loan-details-key">AutoPay <span ng-class="{highlightAutoPay: (loan.autopay.status === 'ON' || autoPayStatusText === 'ON') }">{{autoPayStatusText}}</span>
                                            <a href="#" class="auto-pay-tooltip">
                                                <img ng-src="{{railsVariables.helpIcon}}"  />
                                            </a>
                                        </h6>
                                    </div>
                                    <div class="make-table-cell">
                                        <h6 class="loan-details-value" ng-if="loan.autopay.status === 'OFF' && autoPayStatusText === 'OFF'"><button ng-class="{autoPayDisabled: autoPayDisabled}" class="secondary small-rounded" data-m="button-turn-autopayon" data-pax-event-type="click" data-pax-name="MYACCOUNT:Overview:Turn AutoPayOn CTA:Clicked" ng-click="accountEventTrackerService.trackEvents('event_turn_autopayon');turnOnAutoPayIfAutoPayEnabled()">Turn on AutoPay</button></h6>
                                        <h6 class="loan-details-value" ng-if="loan.autopay.status === 'ON'  || autoPayStatusText === 'ON'">{{loan.autopay.bankName}}&nbsp;{{loan.autopay.account}}</h6>
                                    </div>
                                </div>
                                <div class="make-table-row" ng-show="showLoanDetailsTable">
                                    <div class="make-table-cell">
                                        <h6 class="loan-details-key">Originated:</h6>
                                    </div>
                                    <div class="make-table-cell">
                                        <h6 class="loan-details-value">{{loan.originatedDate}}</h6>
                                    </div>
                                </div>
                                <div class="make-table-row" ng-show="showLoanDetailsTable">
                                    <div class="make-table-cell">
                                        <h6 class="loan-details-key">Loan term:</h6>
                                    </div>
                                    <div class="make-table-cell">
                                        <h6 class="loan-details-value">{{loan.termInMonths}}</h6>
                                    </div>
                                </div>
                                <div class="make-table-row" ng-show="showLoanDetailsTable">
                                    <div class="make-table-cell">
                                        <h6 class="loan-details-key">Maturity date:</h6>
                                    </div>
                                    <div class="make-table-cell">
                                        <h6 class="loan-details-value">{{loan.maturityDate}}</h6>
                                    </div>
                                </div>
                            </div> <!-- ends make-table -->
                        </div>
                    </div>
                    <div class="row loanDetails">
                        <div class="showLoanDetailsLabel" ng-show="!showLoanDetailsTable">
                            <a href="#" class="loans-anchor" ng-click="showLoanDetailsTable = true">Show details</a>
                        </div>
                        <div class="showLoanDetailsLabel" ng-show="showLoanDetailsTable">
                            <a href="#" class="loans-anchor hideDetails" ng-click="showLoanDetailsTable = false">Hide details</a>
                        </div>
                    </div>
                </div>

                <div class="loan-main-content" ng-class="{'loan-fail-wrapper': addFailClass,'loan-confirm-wrapper': addConfirmClass}">

                    <div ng-show="showLoanMainContent">
                        <div class="row loan-pressing-info">
                            <div class="small-12 columns">
                                <div class="row">
                                    <div class="small-8 float-left columns">
                                        <div class="make-inline-block">
                                            <p>{{rightPane.row1.label}}</p>
                                        </div>
                                        <div class="make-inline-block loan-info-help-icon">
                                            <a href="#" class="loan-info-help-icon-tooltip" title="{{rightPane.row1.tooltipText}}">
                                                <img ng-src="{{railsVariables.helpIcon}}"  />
                                            </a>
                                        </div>
                                        <div class="make-inline-block">
                                            <p class="disclaimer">{{rightPane.row1.message}}</p>
                                        </div>
                                    </div>
                                    <div class="small-4 float-right columns text-right">
                                        <div class="">
                                            <p ng-class="{'bold': rightPane.row1.amount === '$0'}">{{rightPane.row1.amount}}</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="small-8 float-left columns">
                                        <div class="make-inline-block">
                                            <p>{{rightPane.row2.label}}</p>
                                        </div>
                                        <div class="make-inline-block loan-info-help-icon">
                                            <a href="#" class="loan-info-help-icon-tooltip" title="{{rightPane.row2.tooltipText}}">
                                                <img ng-src="{{railsVariables.helpIcon}}"  />
                                            </a>
                                        </div>
                                        <div class="make-inline-block">
                                            <p class="disclaimer" ng-bind-html="rightPane.row2.message"></p>
                                        </div>
                                    </div>
                                    <div class="small-4 float-right columns text-right">
                                        <div class="">
                                            <p>{{loan.payment.last.amount | formatZeroAsNA}}</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="row" ng-show="showDetailsThirdRow">
                                    <div class="small-8 float-left columns">
                                        <div class="make-inline-block">
                                            <p ng-class="{'bold': rightPane.row3.boldLabel}">{{rightPane.row3.label}}<span class="bold">{{rightPane.row3.paymentDate}}</span><span ng-show='showDueWarningText' class="warning showDueWarningText make-inline-block">Due in {{dueWarningText}} days</span></p>
                                        </div>
                                        <div class="make-inline-block loan-info-help-icon">
                                            <a href="#" class="loan-info-help-icon-tooltip" title="{{rightPane.row3.tooltipText}}">
                                                <img ng-src="{{railsVariables.helpIcon}}"  />
                                            </a>
                                        </div>
                                        <div class="make-inline-block">
                                            <p class="disclaimer" ng-bind-html="rightPane.row3.message" ng-if="rightPane.row3.message"></p>
                                        </div>
                                    </div>
                                    <div class="small-4 float-right columns text-right">
                                        <div class="">
                                            <p ng-class="{'strong': firstBill}" class="bold">{{loan.monthlyPaymentAmount}}</p>
                                        </div>
                                    </div>
                                </div>

                                <div class="row" ng-show="showDetailsFourRow">
                                    <div class="small-8 float-left columns">
                                        <div class="make-inline-block">
                                            <p ng-bind-html="rightPane.row4.label"></p>
                                        </div>
                                        <div class="make-inline-block loan-info-help-icon">
                                            <a href="#" class="loan-info-help-icon-tooltip" title="{{rightPane.row4.tooltipText}}">
                                                <img ng-src="{{railsVariables.helpIcon}}"  />
                                            </a>
                                        </div>
                                        <div class="make-inline-block">
                                            <p class="disclaimer" ng-bind-html="rightPane.row4.message"></p>
                                        </div>
                                    </div>
                                    <div class="small-4 float-right columns text-right">
                                        <div class="">
                                            <p>{{rightPane.row4.totalMissedPayment}}</p>
                                        </div>
                                    </div>
                                    <div ng-repeat="subRow in rightPane.row4.subRows">
                                        <div class="small-8 float-left columns" >
                                            <div class="make-inline-block">
                                                <p ng-bind-html="subRow.label"></p>
                                            </div>
                                        </div>
                                        <div class="small-4 float-right columns text-right">
                                            <div class="">
                                                <p ng-bind-html="subRow.message"></p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row loan-additional-payment-info" ng-show="showAdditionalInfoRow">
                            <div class="small-12 columns">
                                <p class="micro">{{additionalInfoRowMessage}}</p>
                            </div>
                        </div>
                        <div class="row loan-paidoff-message" ng-show="loan.status === 'CLOSED' && loan.closedStatusBar">This is a big day - it's time to celebrate.</div>
                        <div class="row loan-additional-payment-info" ng-show="loan.status !== 'CLOSED' && showPaymentBar && loan.autopay.status === 'ON'" >
                            <div class="small-12 columns">
                                <p class="micro"> <span>You already have a payment scheduled.</span> If you make additional payments that add up to less than the full amount of your monthly payment before your due date, Prosper will still automatically pull {{loan.due.amount.monthly}} on your due date.</p>
                            </div>
                        </div>
                        <div class="row loan-payment-bar" ng-show="loan.status !== 'CLOSED'">
                            <div class="small-12 small-centered columns">
                                <div ng-show="showPaymentBar" class="row">
                                    <div class="small-12 text-left columns loan-payment-bar-title">
                                        <p ng-show="loan.autopay.status === 'OFF'">MAKE A PAYMENT</p>
                                        <p ng-show="loan.autopay.status === 'ON'">MAKE AN ADDITIONAL PAYMENT</p>
                                    </div>
                                </div>
                                <div ng-show="showPaymentBar" class="row">
                                    <form name="paymentForm" novalidate>
                                        <div class="small-3 columns  make-payment-input-wrapper">
                                            <input type="number"
                                                   name="scheduledPaymentAmount"
                                                   class="scheduledPaymentAmount"
                                                   ng-blur="runPaymentBarPassSanityCheck()"
                                                   ng-pattern="/^\d+(\.\d{1,2})?$/"
                                                   ng-class="{'field-error': paymentForm.scheduledPaymentAmount.$invalid  || fieldError.makePaymentScheduledAmount}"
                                                   required
                                                   ng-model="makePaymentScheduledAmount"  />
                                            <div class="disclaimer scheduledInputFieldError accountArrowBox accountFieldError" ng-class="{'accountFieldError': paymentForm.scheduledPaymentAmount.$invalid  || fieldError.makePaymentScheduledAmount}" ng-show="fieldError.makePaymentScheduledAmount">
                                                {{fieldError.makePaymentScheduledAmount}}
                                            </div>

                                        </div>
                                        <div class="small-4 columns  make-payment-input-wrapper">
                                            <input type="text" class="scheduledPaymentDate" name="validatedDateInput" placeholder="{{placeholderText}}"
                                                   pick-a-date="validatedDate"
                                                   pick-a-date-options='payDateOptions'
                                                   min-date="startDate"
                                                   max-date="endDate"
                                                   ng-model="makePaymentScheduledDate"
                                                   required />
                                            <p class="disclaimer scheduledInputFieldError accountArrowBox accountFieldError" ng-show="fieldError.makePaymentScheduledDate !== null">{{fieldError.makePaymentScheduledDate}}</p>
                                        </div>
                                        <div class="small-5 columns select-bank-account make-payment-input-wrapper">
                                            <select name="selectBankAccount" class="selectBankAccount"
                                                    ng-options="bankAccount.bankAccountNameString for bankAccount in loan.bankAccounts track by bankAccount.wholeBankInfo.account_id"
                                                    ng-class="{'field-error': paymentForm.selectBankAccount.$invalid  || fieldError.makePaymentScheduledAccount}"
                                                    ng-disabled="loan.bankAccounts.length === 0"
                                                    ng-model="makePaymentScheduledAccount">
                                                <option value="" ng-if="loan.bankAccounts.length === 0">No account available</option>
                                            </select>
                                            <p class="disclaimer scheduledInputFieldError accountArrowBox accountFieldError" ng-show="fieldError.makePaymentScheduledAccount !== null">{{fieldError.makePaymentScheduledAccount}}</p>
                                        </div>
                                    </form>
                                </div>

                                <div class="row">
                                    <div class="small-12 small-centered columns make-payment-message" ng-show="payoffAmount !== ''">
                                        <p class="caption make-table-cell clear-left-padding payoff-amount" ng-bind-html="payoffAmount"></p>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="small-5 columns make-payment-message" ng-show="makePayment.message !== ''">
                                        <div class="make-table-cell make-payment-icon-wrapper">
                                            <img class='clock-icon'  ng-src="{{makePayment.footerIcon}}" alt="Clock" />
                                        </div>
                                        <p class="caption make-table-cell" ng-class="{ 'attention': makePayment.footerAttention }" ng-bind-html="makePayment.message"></p>
                                    </div>
                                    <div class="small-6 columns make-payment-action">
                                        <button class="secondary float-right half-padding"  ng-show="showPaymentBar === false && loan.autopay.status === 'ON'" ng-click="showPaymentBar = true;">Make an additional payment</button>
                                        <button class="primary float-right half-padding"  ng-show="showPaymentBar && loan.autopay.status === 'ON'" data-m="button-user-made-additional-payment" ng-click="accountEventTrackerService.trackEvents('event_user_made_additional_payment');validatePaymentFields(true)">Make an additional payment</button>
                                        <button class="primary float-right"  ng-show="loan.autopay.status === 'OFF' && !thinPaymentBtn "  data-m="button-user-made-payment" ng-click="validatePaymentFields(true);accountEventTrackerService.trackEvents('event_user_made_payment');">Make a payment</button>
                                        <button class="secondary float-right half-padding"  ng-show="thinPaymentBtn" ng-click="showPaymentFields(true)">Make a payment</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>


                    <div class="row loan-confirmation" ng-show="showPaymentConfirmation">
                        <div class="small-12 columns">
                            <div class="row text-left">
                                <div class="small-12 columns loan-confirmation-rows-wrapper">
                                    <div class="row loan-confirmation-header">
                                        <div class="small-12 float-left columns confirm-payment-title">
                                            <h3>Confirm your payment</h3>
                                        </div>
                                    </div>
                                    <div class="row loan-additional-payment-info" ng-show="loan.autopay.status === 'ON'">
                                        <div class="small-12 columns">
                                            <p class="micro">If you make additional payments that add up to less than the full amount of your monthly payment, your additional payments will apply to your remaining balance, instead of your monthly payment.
                                                If additional payments posted before your due date satisfy your full monthly payment, no automatic payment will be withdrawn on your due date.
                                        </div>
                                    </div>
                                    <div class="row confirm-payment-info-wrapper confirm-payment-from-wrapper">
                                        <div class="small-12 float-left columns confirm-payment-from">
                                            <h5 class="make-inline-block confirmation-details text-left">From account</h5>
                                            <h5 class="make-inline-block confirmation-details text-right float-right">{{makePaymentScheduledAccount.wholeBankInfo.account_id | formatBankAccountName}}</h5>
                                        </div>
                                    </div>
                                    <div class="row confirm-payment-info-wrapper">
                                        <div class="small-12 float-left columns confirm-payment-date">
                                            <h5 class="make-inline-block confirmation-details text-left">Scheduled payment date</h5>
                                            <h5 class="make-inline-block  confirmation-details text-right float-right">{{makePaymentScheduledDate | formatDate1}}</h5>
                                        </div>
                                    </div>
                                    <div class="row confirm-payment-info-wrapper">
                                        <div class="small-12 float-left columns confirm-payment-amount">
                                            <h5 class="make-inline-block  text-left" ng-show="loan.autopay.status === 'OFF'">Payment amount</h5>
                                            <h5 class="make-inline-block  text-left" ng-show="loan.autopay.status === 'ON'">Additional payment amount</h5>
                                            <h5 class="make-inline-block  text-right float-right">{{makePaymentScheduledAmount | formatCurrency}}</h5>
                                        </div>
                                    </div>
                                    <div class="row confirm-readme-wrapper">
                                        <div class="small-12 float-left columns confirm-readme">
                                            <p class="disclaimer">By clicking 'Confirm your payment', you agree by electronic signature to withdraw from your account.<br><br>
                                                I hereby authorize Prosper Funding LLC ("Prosper"), its parent or any of its affiliates to electronically debit the checking or savings account listed here for which I am an authorized user (“Account”) at the financial institution named here ("Financial Institution") for the transfer of funds in the amount and on the date listed above for the purpose of making a payment towards my loan.  I acknowledge that the origination of electronic debits to my Account must be permitted by my Financial Institution, which must be located in the United States.  I understand that this authorization will remain in full force and effect until Prosper has received oral or written notification from me at least 3 business days prior to my scheduled transfer to terminate this authorization.
                                                <br><br>
                                                I further acknowledge that, if I have authorized monthly automatic ACH loan payments from my Account, my next monthly loan payment will be reduced by the payment amount listed above.
                                                <br><br>
                                                Please print this authorization and retain a copy for your records.
                                             </p>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="small-12 float-left columns confirm-payment-action">

                                            <button class="primary float-right half-padding" ng-disabled="paymentRequestInProgress" ng-show="loan.autopay.status === 'OFF'" data-m="button-user-confirm-payment"  data-pax-name="MYACCOUNT:Payment:Confirm Payment CTA:Clicked" data-pax-event-type="click" ng-click="accountEventTrackerService.trackEvents('event_confirm_payment');handlePayment('manual')">Confirm your payment</button>
                                            <button class="primary float-right half-padding" ng-disabled="paymentRequestInProgress" ng-show="loan.autopay.status === 'ON'" data-m="button-user-confirm-payment" data-pax-name="MYACCOUNT:Payment:Confirm Payment CTA:Clicked" data-pax-event-type="click" ng-click="accountEventTrackerService.trackEvents('event_confirm_payment');handlePayment('auto')">Confirm your payment</button>
                                            <button class="secondary gray half-padding float-right" ng-disabled="paymentRequestInProgress" data-m="button-user-edited-payment" ng-click="accountEventTrackerService.trackEvents('event_user_edited_payment_details');showPaymentConfirmation = false; showLoanMainContent = true">Edit</button>

                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- success payment Confirmation tmpl-->
                    <div class="row loan-success-confirmation" ng-show="showSuccessPaymentConfirmation">
                        <div class="small-12 columns">
                            <div class="row text-left">
                                <div class="small-12 columns loan-confirmation-rows-wrapper">
                                    <div class="small-12 float-left columns confirm-payment-title">
                                        <div class="row text-center">
                                            <h3>You have scheduled a payment</h3>
                                        </div>
                                    </div>
                                    <div class="row confirm-payment-info-wrapper confirm-payment-from-wrapper">
                                        <div class="small-12 float-left columns confirm-payment-from">
                                            <h5 class="make-inline-block confirmation-details text-left">From account</h5>
                                            <h5 class="make-inline-block confirmation-details text-right float-right">{{makePaymentScheduledAccount.wholeBankInfo.account_id | formatBankAccountName}}</h5>
                                        </div>
                                    </div>
                                    <div class="row confirm-payment-info-wrapper">
                                        <div class="small-12 float-left columns confirm-payment-date">
                                            <h5 class="make-inline-block confirmation-details text-left">Scheduled payment date</h5>
                                            <h5 class="make-inline-block  confirmation-details text-right float-right">{{makePaymentScheduledDate | formatDate1}}</h5>
                                        </div>
                                    </div>
                                    <div class="row confirm-payment-info-wrapper">
                                        <div class="small-12 float-left columns confirm-payment-amount">
                                            <h5 class="make-inline-block  text-left">Payment amount</h5>
                                            <h5 class="make-inline-block  text-right float-right">{{makePaymentScheduledAmount | formatCurrency}}</h5>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="small-12 small-centered text-center columns confirm-payment-action">
                                            <button class="secondary gray green-light" ng-disabled="paymentRequestInProgress" ng-click="backToLoan();addConfirmClass=false;">Back to your loan</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Failed payment Confirmation tmpl-->

                    <div class="row loan-failed-confirmation" ng-show="showFailedPaymentConfirmation">
                        <div class="small-12 columns">
                            <div class="row text-left">
                                <div class="small-12 columns loan-confirmation-rows-wrapper">
                                    <div class="small-12 float-left columns confirm-payment-title">
                                        <div class="row text-center">
                                            <h3>Unable to process your payment</h3>
                                            <p>Please try again later or <a class='contactUsLink' href="/help/support.aspx" target="_self">contact us.</a></p>
                                        </div>
                                    </div>

                                    <div class="row confirm-payment-info-wrapper confirm-payment-from-wrapper">
                                        <div class="small-12 float-left columns confirm-payment-from">
                                            <h5 class="make-inline-block confirmation-details text-left">From account</h5>
                                            <h5 class="make-inline-block confirmation-details text-right float-right">{{makePaymentScheduledAccount.wholeBankInfo.account_id | formatBankAccountName}}</h5>
                                        </div>
                                    </div>
                                    <div class="row confirm-payment-info-wrapper">
                                        <div class="small-12 float-left columns confirm-payment-date">
                                            <h5 class="make-inline-block confirmation-details text-left">Scheduled payment date</h5>
                                            <h5 class="make-inline-block  confirmation-details text-right float-right">{{makePaymentScheduledDate | formatDate1}}</h5>
                                        </div>
                                    </div>
                                    <div class="row confirm-payment-info-wrapper">
                                        <div class="small-12 float-left columns confirm-payment-amount">
                                            <h5 class="make-inline-block  text-left" >Payment amount</h5>
                                            <h5 class="make-inline-block  text-right float-right">{{makePaymentScheduledAmount | formatCurrency}}</h5>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="small-12 small-centered text-center columns confirm-payment-action">
                                            <button class="gray red-light" ng-disabled="paymentRequestInProgress" ng-click="backToLoan();addFailClass=false">Back to your loan</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <auto-ach ng-show="showAutoACH"></auto-ach>
                </div>

            </div>
        </div>
        <prosper-feature-flagged name="paymentDetails" variant="new">
            <pr-payment-details></pr-payment-details>
        </prosper-feature-flagged>
    </div>
</div>



